<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>National Center for Mental Health in Saudi Arabia</title>
    <style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: Arial, sans-serif;
        background: linear-gradient(135deg, #1a7f37 0%, #0d5c29 100%);
        min-height: 100vh;
        padding: 40px 20px;
    }

    body.rtl {
        direction: rtl;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .container {
        max-width: 1000px;
        margin: 0 auto;
        background: white;
        padding: 100px 50px 60px 50px;
        border-radius: 8px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        border-top: 5px solid #1a7f37;
        min-height: 80vh;
    }

    .page {
        display: none;
    }

    .page.active {
        display: block;
    }

    h1 {
        text-align: center;
        font-size: 32px;
        font-weight: bold;
        color: #c9a961;
        margin-bottom: 60px;
        margin-top: 80px;
        line-height: 1.4;
    }

    h2 {
        text-align: center;
        font-size: 28px;
        font-weight: bold;
        color: #c9a961;
        margin-bottom: 40px;
    }

    .description {
        text-align: left;
        font-size: 18px;
        color: #333;
        line-height: 2;
        max-width: 700px;
        margin: 0 auto;
    }

    .rtl .description {
        text-align: right;
    }

    .button {
        background: #1a7f37;
        color: white;
        border: none;
        padding: 15px 40px;
        font-size: 16px;
        font-weight: bold;
        border-radius: 5px;
        cursor: pointer;
        margin-top: 40px;
        display: block;
        margin-left: auto;
        margin-right: auto;
        transition: background 0.3s;
    }

    .button:hover {
        background: #0d5c29;
    }

    .tabs {
        display: flex;
        justify-content: center;
        gap: 0;
        margin-bottom: 40px;
        border-bottom: 2px solid #e0e0e0;
    }

    .tab {
        padding: 15px 40px;
        background: none;
        border: none;
        font-size: 18px;
        font-weight: bold;
        color: #666;
        cursor: pointer;
        position: relative;
        transition: color 0.3s;
    }

    .tab.active {
        color: #1a7f37;
    }

    .tab.active::after {
        content: '';
        position: absolute;
        bottom: -2px;
        left: 0;
        right: 0;
        height: 3px;
        background: #1a7f37;
    }

    .tab:hover {
        color: #1a7f37;
    }

    .tab-content {
        display: none;
        max-width: 500px;
        margin: 0 auto;
    }

    .tab-content.active {
        display: block;
    }

    .form-group {
        margin-bottom: 25px;
    }

    label {
        display: block;
        margin-bottom: 8px;
        color: #333;
        font-weight: 600;
        font-size: 15px;
    }

    input[type="email"], input[type="password"], input[type="text"], input[type="tel"] {
        width: 100%;
        padding: 12px 15px;
        border: 2px solid #e0e0e0;
        border-radius: 5px;
        font-size: 15px;
        transition: border-color 0.3s;
    }

    input:focus {
        outline: none;
        border-color: #1a7f37;
    }

    .forgot-link, .back-link {
        color: #1a7f37;
        text-decoration: none;
        font-size: 14px;
        display: inline-block;
        margin-top: 10px;
        cursor: pointer;
    }

    .forgot-link:hover, .back-link:hover {
        text-decoration: underline;
    }

    .forgot-section {
        display: none;
        margin-top: 30px;
        padding-top: 30px;
        border-top: 1px solid #e0e0e0;
    }

    .forgot-section.active {
        display: block;
    }

    .create-account-section {
        text-align: center;
        padding: 40px 0;
    }

    .create-account-section p {
        font-size: 16px;
        color: #666;
        margin-bottom: 25px;
        line-height: 1.6;
    }

    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
    }

    .form-section {
        margin-bottom: 35px;
        padding-bottom: 25px;
        border-bottom: 1px solid #e8e8e8;
    }

    .form-section:last-of-type {
        border-bottom: none;
    }

    .form-section h3 {
        font-size: 18px;
        color: #1a7f37;
        margin-bottom: 20px;
        font-weight: 600;
    }

    select {
        width: 100%;
        padding: 12px 15px;
        border: 2px solid #e0e0e0;
        border-radius: 5px;
        font-size: 15px;
        background: white;
        cursor: pointer;
    }

    select:focus {
        outline: none;
        border-color: #1a7f37;
    }

    textarea {
        width: 100%;
        padding: 12px 15px;
        border: 2px solid #e0e0e0;
        border-radius: 5px;
        font-size: 15px;
        min-height: 150px;
        resize: vertical;
        font-family: inherit;
    }

    textarea:focus {
        outline: none;
        border-color: #1a7f37;
    }

    .terms-box {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 5px;
        margin: 30px 0;
        border: 1px solid #e0e0e0;
    }

    .terms-box label {
        display: flex;
        align-items: start;
        cursor: pointer;
        font-weight: normal;
    }

    .terms-box input[type="checkbox"] {
        margin-right: 12px;
        margin-top: 4px;
        width: 18px;
        height: 18px;
        cursor: pointer;
        flex-shrink: 0;
    }

    .rtl .terms-box input[type="checkbox"] {
        margin-right: 0;
        margin-left: 12px;
    }

    .terms-box span {
        font-size: 14px;
        color: #333;
        line-height: 1.7;
    }

    .facility-card {
        background: white;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        padding: 20px;
        transition: all 0.3s;
        cursor: pointer;
        margin-bottom: 20px;
        position: relative;
    }

    .facility-card:hover {
        border-color: #1a7f37;
        box-shadow: 0 4px 12px rgba(26, 127, 55, 0.1);
        transform: translateY(-2px);
    }

    .facility-card.selected {
        border-color: #1a7f37;
        background: #f0f8f4;
    }

    .chatbot-button {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: #1a7f37;
        color: white;
        border: none;
        font-size: 28px;
        cursor: pointer;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        z-index: 1000;
        transition: all 0.3s;
    }

    .rtl .chatbot-button {
        right: auto;
        left: 30px;
    }

    .chatbot-button:hover {
        background: #0d5c29;
        transform: scale(1.1);
    }

    .chatbot-window {
        position: fixed;
        bottom: 100px;
        right: 30px;
        width: 350px;
        height: 500px;
        background: white;
        border-radius: 12px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        display: none;
        flex-direction: column;
        z-index: 999;
    }

    .rtl .chatbot-window {
        right: auto;
        left: 30px;
    }

    .chatbot-window.open {
        display: flex;
    }

    .chatbot-header {
        background: #1a7f37;
        color: white;
        padding: 15px;
        border-radius: 12px 12px 0 0;
        font-weight: bold;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .chatbot-close {
        background: none;
        border: none;
        color: white;
        font-size: 24px;
        cursor: pointer;
        line-height: 1;
    }

    .chatbot-messages {
        flex: 1;
        overflow-y: auto;
        padding: 15px;
        background: #f5f5f5;
    }

    .message {
        margin-bottom: 15px;
        padding: 10px 15px;
        border-radius: 12px;
        max-width: 80%;
        word-wrap: break-word;
        animation: fadeIn 0.3s;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .message.bot {
        background: #e8f5e9;
        margin-right: auto;
    }

    .message.user {
        background: #1a7f37;
        color: white;
        margin-left: auto;
        text-align: right;
    }

    .rtl .message.bot {
        margin-right: 0;
        margin-left: auto;
        text-align: right;
    }

    .rtl .message.user {
        margin-left: 0;
        margin-right: auto;
        text-align: left;
    }

    .chatbot-input {
        display: flex;
        padding: 15px;
        border-top: 1px solid #e0e0e0;
        background: white;
    }

    .chatbot-input input {
        flex: 1;
        padding: 10px;
        border: 1px solid #e0e0e0;
        border-radius: 20px;
        margin-right: 10px;
        font-size: 14px;
    }

    .rtl .chatbot-input input {
        margin-right: 0;
        margin-left: 10px;
    }

    .chatbot-input button {
        background: #1a7f37;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 20px;
        cursor: pointer;
        font-weight: bold;
    }

    .chatbot-input button:hover {
        background: #0d5c29;
    }

    .map-container {
        width: 100%;
        height: 400px;
        border-radius: 8px;
        margin: 20px 0;
        border: 2px solid #e0e0e0;
        background: #f0f0f0;
        position: relative;
        overflow: hidden;
    }

    .map-placeholder {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        color: #666;
    }

    .map-placeholder svg {
        width: 60px;
        height: 60px;
        margin-bottom: 15px;
        fill: #1a7f37;
    }

    .ai-badge {
        display: inline-block;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: bold;
        margin-left: 10px;
        vertical-align: middle;
    }

    .rtl .ai-badge {
        margin-left: 0;
        margin-right: 10px;
    }

    .sentiment-indicator {
        display: inline-block;
        padding: 12px 20px;
        border-radius: 8px;
        font-size: 14px;
        font-weight: bold;
        margin-top: 15px;
        animation: slideIn 0.5s;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateX(-20px);
        }

        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    .sentiment-positive {
        background: #d4edda;
        color: #155724;
        border-left: 4px solid #28a745;
    }

    .sentiment-neutral {
        background: #fff3cd;
        color: #856404;
        border-left: 4px solid #ffc107;
    }

    .sentiment-negative {
        background: #f8d7da;
        color: #721c24;
        border-left: 4px solid #dc3545;
    }

    .distance-badge {
        display: inline-block;
        background: #e3f2fd;
        color: #1976d2;
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 12px;
        margin-left: 10px;
    }

    .typing-indicator {
        display: inline-block;
    }

    .typing-indicator span {
        display: inline-block;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: #1a7f37;
        margin: 0 2px;
        animation: typing 1.4s infinite;
    }

    .typing-indicator span:nth-child(2) {
        animation-delay: 0.2s;
    }

    .typing-indicator span:nth-child(3) {
        animation-delay: 0.4s;
    }

    @keyframes typing {
        0%, 60%, 100% {
            transform: translateY(0);
        }

        30% {
            transform: translateY(-10px);
        }
    }

    @media (max-width: 768px) {
        .form-row {
            grid-template-columns: 1fr;
        }

        .chatbot-window {
            width: 90%;
            right: 5%;
            max-width: 350px;
        }

        .rtl .chatbot-window {
            right: auto;
            left: 5%;
        }

        .container {
            padding: 60px 30px 40px 30px;
        }
    }
    </style>
</head>
<body>
    <div class="container">
        <!-- Page 1: Home -->
        <div class="page active" id="page1">
            <h1 data-translate="home_title">
                National Center for Mental Health
                <br>
                in Saudi Arabia
            </h1>
            <p class="description" data-translate="home_description">
                Welcome to the confidential user-friendly platform that encourages seeking support and makes it simple and accessible to all. Our core feature is the 
                <strong>AI-Empowered Triage center</strong>
                , a platform that acts as your private decision-making tool.
            </p>
            <button class="button" onclick="showPage('page2')" data-translate="get_started">Get Started</button>
        </div>

        <!-- Page 2: Sign In/Sign Up -->
        <div class="page" id="page2">
            <h2 data-translate="welcome">Welcome</h2>
            <div class="tabs">
                <button class="tab active" onclick="showTab('signin')" data-translate="signin">Sign In</button>
                <button class="tab" onclick="showTab('signup')" data-translate="signup">Sign Up</button>
            </div>
            <div class="tab-content active" id="signin-content">
                <div id="signin-message" style="display: none; padding: 15px; margin-bottom: 20px; border-radius: 5px; text-align: center; font-weight: bold;"></div>
                <form onsubmit="event.preventDefault(); handleSignIn();">
                    <div class="form-group">
                        <label for="signin-username" data-translate="username">Username</label>
                        <input type="text" id="signin-username" required>
                    </div>
                    <div class="form-group">
                        <label for="signin-password" data-translate="password">Password</label>
                        <input type="password" id="signin-password" required>
                    </div>
                    <button type="submit" class="button" data-translate="login">Log In</button>
                </form>
                <a class="forgot-link" onclick="showForgotPassword()" data-translate="forgot_password">Forgot your password?</a>
                <div class="forgot-section" id="forgot-section">
                    <h3 style="font-size: 20px; color: #333; margin-bottom: 20px;" data-translate="reset_password">Reset Your Password</h3>
                    <div class="form-group">
                        <label for="forgot-email" data-translate="email_or_username">Email Address or Username</label>
                        <input type="text" id="forgot-email" required>
                    </div>
                    <button class="button" onclick="sendResetLink()" data-translate="send_reset">Send Reset Link</button>
                    <a class="back-link" onclick="hideForgotPassword()" data-translate="back_signin">â† Back to Sign In</a>
                </div>
            </div>
            <div class="tab-content" id="signup-content">
                <div class="create-account-section">
                    <p data-translate="signup_message">
                        Ready to begin your journey to better mental health?
                        <br>
                        Create your account to access personalized support and resources.
                    </p>
                    <button class="button" onclick="showPage('page3')" data-translate="create_account">Create Account</button>
                </div>
            </div>
            <p style="text-align: center; margin-top: 30px;">
                <a class="back-link" onclick="showPage('page1')" data-translate="back_home">â† Back to Home</a>
            </p>
        </div>

        <!-- Page 3: Create Account -->
        <div class="page" id="page3">
            <h2 data-translate="create_your_account">Create Your Account</h2>
            <form onsubmit="event.preventDefault(); handleAccountCreation();" style="max-width: 700px; margin: 0 auto;">
                <div class="form-section">
                    <h3 data-translate="personal_info">Personal Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label data-translate="first_name">First Name *</label>
                            <input type="text" id="firstname" required>
                        </div>
                        <div class="form-group">
                            <label data-translate="last_name">Last Name *</label>
                            <input type="text" id="lastname" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label data-translate="preferred_language">Preferred Language *</label>
                        <select id="language" required onchange="changeLanguage(this.value)">
                            <option value="">Select language / Ø§Ø®ØªØ± Ø§Ù„Ù„ØºØ©</option>
                            <option value="english">English</option>
                            <option value="arabic">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                        </select>
                    </div>
                </div>
                <div class="form-section">
                    <h3 data-translate="contact_info">Contact Information</h3>
                    <div class="form-group">
                        <label data-translate="email">Email Address *</label>
                        <input type="email" id="email" required>
                    </div>
                    <div class="form-group">
                        <label data-translate="username">Username *</label>
                        <input type="text" id="username" required>
                    </div>
                    <div class="form-group">
                        <label data-translate="password">Password *</label>
                        <input type="password" id="password" required>
                    </div>
                </div>
                <div class="terms-box">
                    <label>
                        <input type="checkbox" required>
                        <span data-translate="terms_agree">I agree to the Terms and Conditions</span>
                    </label>
                </div>
                <button type="submit" class="button" data-translate="create_account">Create Account</button>
                <p style="text-align: center; margin-top: 20px;">
                    <a class="back-link" onclick="showPage('page2')" data-translate="back">â† Back</a>
                </p>
            </form>
        </div>

        <!-- Page 4: Email Verification -->
        <div class="page" id="page4">
            <div style="text-align: center; padding: 60px 20px;">
                <div style="font-size: 60px; color: #1a7f37; margin-bottom: 30px;">âœ“</div>
                <h2 data-translate="verify_email">Verify Your Email</h2>
                <p style="color: #666; max-width: 500px; margin: 30px auto;" data-translate="verification_sent">A verification code has been sent to your email.</p>
                <button class="button" onclick="showPage('page2')" style="margin-top: 40px;" data-translate="return_signin">Return to Sign In</button>
            </div>
        </div>

        <!-- Page 5: AI Sentiment Analysis -->
        <div class="page" id="page5">
            <h2>
                <span data-translate="how_feeling">How are you feeling?</span>
                <span class="ai-badge">ğŸ¤– AI POWERED</span>
            </h2>
            <form onsubmit="event.preventDefault(); analyzeSentiment();" style="max-width: 600px; margin: 0 auto;">
                <div class="form-group">
                    <label data-translate="im_feeling">I'm feeling...</label>
                    <select id="feeling" required>
                        <option value="" data-translate="select_option">Select an option</option>
                        <option value="sad">
                            ğŸ˜¢ 
                            <span data-translate="sad">Sad</span>
                        </option>
                        <option value="overwhelmed">
                            ğŸ˜° 
                            <span data-translate="overwhelmed">Overwhelmed</span>
                        </option>
                        <option value="school-stress">
                            ğŸ“š 
                            <span data-translate="school_stress">School stress</span>
                        </option>
                        <option value="workplace-stress">
                            ğŸ’¼ 
                            <span data-translate="workplace_stress">Workplace stress</span>
                        </option>
                        <option value="family-stress">
                            ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ 
                            <span data-translate="family_stress">Family stress</span>
                        </option>
                        <option value="anxiety">
                            ğŸ˜Ÿ 
                            <span data-translate="anxiety">Anxiety</span>
                        </option>
                        <option value="depression">
                            ğŸ˜” 
                            <span data-translate="depression">Depression</span>
                        </option>
                        <option value="cannot-sleep">
                            ğŸ˜´ 
                            <span data-translate="cannot_sleep">Cannot sleep</span>
                        </option>
                        <option value="panic-attack">
                            ğŸ˜¨ 
                            <span data-translate="panic_attack">Panic attack</span>
                        </option>
                        <option value="suicidal">
                            ğŸ’” 
                            <span data-translate="suicidal">Suicidal</span>
                        </option>
                        <option value="other">
                            ğŸ¤” 
                            <span data-translate="other">Other</span>
                        </option>
                    </select>
                </div>
                <div class="form-group">
                    <label data-translate="additional_details">Additional details (optional)</label>
                    <textarea id="additional-details" placeholder="Share as much or as little as you're comfortable with..."></textarea>
                </div>
                <div id="sentiment-result"></div>
                <button type="submit" class="button" data-translate="continue">Continue</button>
                <p style="text-align: center; margin-top: 20px;">
                    <a class="back-link" onclick="showPage('page1')" data-translate="back_home">â† Back to Home</a>
                </p>
            </form>
        </div>

        <!-- Page 6: Support Options -->
        <div class="page" id="page6">
            <h2 data-translate="support_type">Type of support requested</h2>
            <form onsubmit="event.preventDefault(); handleSupportSelection();" style="max-width: 600px; margin: 0 auto;">
                <div style="background: #f8f9fa; padding: 30px; border-radius: 8px; margin-bottom: 20px;">
                    <label style="display: flex; align-items: center; padding: 15px; cursor: not-allowed; opacity: 0.5;">
                        <input type="checkbox" disabled style="margin-right: 15px; width: 20px; height: 20px;">
                        <span style="font-size: 16px;" data-translate="resources_coming">Resources (Coming soon)</span>
                    </label>
                    <label style="display: flex; align-items: center; padding: 15px; cursor: not-allowed; opacity: 0.5;">
                        <input type="checkbox" disabled style="margin-right: 15px; width: 20px; height: 20px;">
                        <span style="font-size: 16px;" data-translate="counselor_coming">Counselor (Coming soon)</span>
                    </label>
                    <label style="display: flex; align-items: center; padding: 15px; cursor: pointer; background: white; border-radius: 5px; border: 2px solid #e0e0e0;">
                        <input type="checkbox" id="healthcare-check" style="margin-right: 15px; width: 20px; height: 20px; cursor: pointer;">
                        <span style="font-size: 16px; font-weight: 600;" data-translate="healthcare_facilities">Health Care Facilities</span>
                    </label>
                </div>
                <button type="submit" class="button" data-translate="continue">Continue</button>
                <p style="text-align: center; margin-top: 20px;">
                    <a class="back-link" onclick="showPage('page5')" data-translate="back">â† Back</a>
                </p>
            </form>
        </div>

        <!-- Page 7: Facilities with Simple Map -->
        <div class="page" id="page7">
            <h2 data-translate="healthcare_facilities">Health Care Facilities</h2>
            <div style="max-width: 900px; margin: 0 auto;">
                <div style="margin-bottom: 30px;">
                    <div class="form-group">
                        <label data-translate="enter_location">Enter your location</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="location-search" placeholder="City or Region" style="flex: 1;">
                            <button class="button" onclick="searchLocation()" style="margin: 0; padding: 12px 30px;" data-translate="search">Search</button>
                        </div>
                    </div>
                </div>

                <div class="map-container">
                    <div class="map-placeholder">
                        <svg viewBox="0 0 24 24">
                            <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                        </svg>
                        <h3 style="margin-bottom: 10px;" data-translate="map_title">Mental Health Facilities Map</h3>
                        <p data-translate="map_subtitle">Search for your city to find the nearest facility</p>
                        <div id="distance-info" style="margin-top: 15px; font-weight: bold; color: #1a7f37;"></div>
                    </div>
                </div>

                <h3 style="font-size: 20px; color: #1a7f37; margin: 30px 0 20px;" data-translate="government_facilities">Government Mental Health Facilities</h3>

                <div class="facility-card" data-city="riyadh" data-lat="24.7136" data-lng="46.6753" onclick="selectFacility(this)">
                    <h4 style="color: #1a7f37; margin-bottom: 10px; font-size: 18px;">ğŸ¥ Al-Amal Hospital - Riyadh</h4>
                    <p style="color: #666; font-size: 14px;">ğŸ“ Riyadh | Psychiatric treatment and addiction services</p>
                    <p style="color: #999; font-size: 13px; margin-top: 8px;">ğŸ“ Phone: +966 11 234 5678</p>
                    <span class="distance-badge" style="display: none;"></span>
                </div>

                <p style="text-align: center; margin-top: 30px;">
                    <a class="back-link" onclick="showPage('page6')" data-translate="back_support">â† Back to Support Options</a>
                </p>
                <p style="text-align: center; margin-top: 10px;">
                    <a class="back-link" onclick="showPage('page1')" data-translate="back_home">â† Back to Home</a>
                </p>
            </div>
        </div>
    </div>

    <!-- AI-Powered Chatbot (Feature #2) -->
    <button class="chatbot-button" onclick="toggleChatbot()">ğŸ’¬</button>
    <div class="chatbot-window" id="chatbot">
        <div class="chatbot-header">
            <span>
                <span id="chatbot-title">Mental Health Support</span>
                <span class="ai-badge" style="font-size: 9px; padding: 3px 8px;">AI</span>
            </span>
            <button class="chatbot-close" onclick="toggleChatbot()">Ã—</button>
        </div>
        <div class="chatbot-messages" id="chatMessages"></div>
        <div class="chatbot-input">
            <input type="text" id="chatInput" placeholder="Type a message...">
            <button onclick="sendMessage()">Send</button>
        </div>
    </div>

    <script>
    var currentLang = 'english';
    var userLocation = null;
    var chatHistory = [];

    // Complete translations object
    var translations = {
        english: {
            home_title: 'National Center for Mental Health<br>in Saudi Arabia',
            home_description: 'Welcome to the confidential user-friendly platform that encourages seeking support and makes it simple and accessible to all. Our core feature is the <strong>AI-Empowered Triage center</strong>, a platform that acts as your private decision-making tool.',
            get_started: 'Get Started',
            welcome: 'Welcome',
            signin: 'Sign In',
            signup: 'Sign Up',
            username: 'Username',
            password: 'Password',
            login: 'Log In',
            forgot_password: 'Forgot your password?',
            reset_password: 'Reset Your Password',
            email_or_username: 'Email Address or Username',
            send_reset: 'Send Reset Link',
            back_signin: 'â† Back to Sign In',
            signup_message: 'Ready to begin your journey to better mental health?<br>Create your account to access personalized support and resources.',
            create_account: 'Create Account',
            back_home: 'â† Back to Home',
            create_your_account: 'Create Your Account',
            personal_info: 'Personal Information',
            first_name: 'First Name *',
            last_name: 'Last Name *',
            preferred_language: 'Preferred Language *',
            contact_info: 'Contact Information',
            email: 'Email Address *',
            terms_agree: 'I agree to the Terms and Conditions',
            back: 'â† Back',
            verify_email: 'Verify Your Email',
            verification_sent: 'A verification code has been sent to your email.',
            return_signin: 'Return to Sign In',
            how_feeling: 'How are you feeling?',
            im_feeling: "I'm feeling...",
            select_option: 'Select an option',
            sad: 'Sad',
            overwhelmed: 'Overwhelmed',
            school_stress: 'School stress',
            workplace_stress: 'Workplace stress',
            family_stress: 'Family stress',
            anxiety: 'Anxiety',
            depression: 'Depression',
            cannot_sleep: 'Cannot sleep',
            panic_attack: 'Panic attack',
            suicidal: 'Suicidal',
            other: 'Other',
            additional_details: 'Additional details (optional)',
            continue: 'Continue',
            support_type: 'Type of support requested',
            resources_coming: 'Resources (Coming soon)',
            counselor_coming: 'Counselor (Coming soon)',
            healthcare_facilities: 'Health Care Facilities',
            enter_location: 'Enter your location',
            search: 'Search',
            government_facilities: 'Government Mental Health Facilities',
            back_support: 'â† Back to Support Options',
            map_title: 'Mental Health Facilities Map',
            map_subtitle: 'Search for your city to find the nearest facility',
            reset_link_sent: 'Password reset link sent to your email!',
            signin_success: 'âœ“ Sign in successful!',
            signin_error: 'âœ— Invalid credentials. Please try again.',
            location_prompt: 'Please enter your location',
            select_support: 'Please select at least one support option',
            sentiment_positive: 'âœ“ AI Analysis: Your message shows resilience and hope. You\'re taking positive steps forward.',
            sentiment_neutral: 'âš  AI Analysis: You seem to be processing complex feelings. That\'s completely normal.',
            sentiment_negative: 'âš  AI Analysis: We detect you may need urgent support. Please don\'t hesitate to reach out for help.',
            nearest_facility: 'Nearest facility:',
            km_away: 'km away',
            // Chatbot responses
            chat_greeting: 'Hello! I\'m your AI mental health assistant. ğŸ¤– I can help you with:\n\nâ€¢ Finding mental health resources\nâ€¢ Understanding your feelings\nâ€¢ Connecting with facilities\nâ€¢ Crisis support\n\nHow can I help you today?',
            crisis_response: 'ğŸš¨ I understand you\'re in crisis. Your life matters.\n\nPLEASE CALL: 920033360 (Saudi Mental Health Hotline) - Available 24/7\n\nYou can also text them. Would you like me to show you nearby emergency facilities?',
            anxiety_response: 'ğŸ˜° Anxiety can feel overwhelming, but you\'re not alone.\n\nâœ¨ Try this now:\nâ€¢ Breathe in slowly for 4 counts\nâ€¢ Hold for 4 counts\nâ€¢ Exhale for 4 counts\nâ€¢ Repeat 5 times\n\nWould you like to see our anxiety management resources or speak with a professional?',
            depression_response: 'ğŸ’™ Thank you for sharing. Depression is a real medical condition, and it\'s treatable.\n\nYou deserve support. Our facilities offer:\nâ€¢ Professional counseling\nâ€¢ Medical treatment\nâ€¢ Support groups\n\nWould you like to see nearby mental health centers?',
            stress_response: 'ğŸ˜“ Stress affects everyone differently. Let me help you find the right support.\n\nWhat type of stress are you experiencing?\nâ€¢ Work/School\nâ€¢ Family\nâ€¢ Financial\nâ€¢ Health\n\nI can provide tailored coping strategies.',
            sleep_response: 'ğŸ˜´ Sleep issues often connect to mental health.\n\nğŸ’¡ Tips for better sleep:\nâ€¢ Stick to a schedule\nâ€¢ Avoid screens 1hr before bed\nâ€¢ Create a calming routine\nâ€¢ Keep room cool & dark\n\nIf this persists, our specialists can help. Would you like to book a consultation?',
            facilities_response: 'ğŸ¥ I can show you mental health facilities in Saudi Arabia.\n\nWe have centers in:\nâ€¢ Riyadh - Al-Amal Hospital\nâ€¢ Jeddah - Al-Amal Hospital\nâ€¢ Dammam - Al-Amal Hospital\n\nWhich city are you closest to, or would you like to see all locations?',
            thank_response: 'ğŸ’š You\'re very welcome! Remember:\n\nâœ¨ Seeking help is a sign of STRENGTH, not weakness\nâœ¨ You don\'t have to face this alone\nâœ¨ Recovery is possible\n\nI\'m always here if you need support. Take care of yourself!',
            help_response: 'ğŸ¤ I\'m here to support you. I can help with:\n\n1ï¸âƒ£ Crisis support & emergency contacts\n2ï¸âƒ£ Understanding mental health conditions\n3ï¸âƒ£ Finding nearby facilities\n4ï¸âƒ£ Coping strategies & techniques\n5ï¸âƒ£ Booking appointments\n\nWhat would be most helpful for you right now?',
            default_response: 'I\'m listening. ğŸ‘‚ Your feelings are valid.\n\nCould you tell me more about what you\'re experiencing? The more you share, the better I can help you find the right support.',
            how_can_help: 'How can I help you?',
            im_thinking: 'I\'m thinking...'
        },
        arabic: {
            home_title: 'Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„ÙˆØ·Ù†ÙŠ Ù„Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ©<br>ÙÙŠ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
            home_description: 'Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ø³Ø±ÙŠØ© ÙˆØ³Ù‡Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªÙŠ ØªØ´Ø¬Ø¹ Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ø§Ù„Ø¯Ø¹Ù… ÙˆØªØ¬Ø¹Ù„Ù‡ Ø¨Ø³ÙŠØ·Ø§Ù‹ ÙˆÙ…ØªØ§Ø­Ø§Ù‹ Ù„Ù„Ø¬Ù…ÙŠØ¹. Ù…ÙŠØ²ØªÙ†Ø§ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù‡ÙŠ <strong>Ù…Ø±ÙƒØ² Ø§Ù„ÙØ±Ø² Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ… Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</strong>ØŒ Ù…Ù†ØµØ© ØªØ¹Ù…Ù„ ÙƒØ£Ø¯Ø§Ø© Ø®Ø§ØµØ© Ù„Ø§ØªØ®Ø§Ø° Ø§Ù„Ù‚Ø±Ø§Ø±.',
            get_started: 'Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†',
            welcome: 'Ù…Ø±Ø­Ø¨Ø§Ù‹',
            signin: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
            signup: 'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨',
            username: 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…',
            password: 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±',
            login: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
            forgot_password: 'Ù‡Ù„ Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ',
            reset_password: 'Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±',
            email_or_username: 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…',
            send_reset: 'Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†',
            back_signin: 'â†’ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
            signup_message: 'Ù‡Ù„ Ø£Ù†Øª Ù…Ø³ØªØ¹Ø¯ Ù„Ø¨Ø¯Ø¡ Ø±Ø­Ù„ØªÙƒ Ù†Ø­Ùˆ ØµØ­Ø© Ù†ÙØ³ÙŠØ© Ø£ÙØ¶Ù„ØŸ<br>Ø£Ù†Ø´Ø¦ Ø­Ø³Ø§Ø¨Ùƒ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø¯Ø¹Ù… ÙˆØ§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ù…Ø®ØµØµØ©.',
            create_account: 'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨',
            back_home: 'â†’ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©',
            create_your_account: 'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨Ùƒ',
            personal_info: 'Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©',
            first_name: 'Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ *',
            last_name: 'Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© *',
            preferred_language: 'Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…ÙØ¶Ù„Ø© *',
            contact_info: 'Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„',
            email: 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ *',
            terms_agree: 'Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…',
            back: 'â†’ Ø±Ø¬ÙˆØ¹',
            verify_email: 'ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ',
            verification_sent: 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.',
            return_signin: 'Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
            how_feeling: 'ÙƒÙŠÙ ØªØ´Ø¹Ø±ØŸ',
            im_feeling: 'Ø£Ù†Ø§ Ø£Ø´Ø¹Ø±...',
            select_option: 'Ø§Ø®ØªØ± Ø®ÙŠØ§Ø±Ø§Ù‹',
            sad: 'Ø­Ø²ÙŠÙ†',
            overwhelmed: 'Ù…Ø±Ù‡Ù‚',
            school_stress: 'Ø¶ØºØ· Ø¯Ø±Ø§Ø³ÙŠ',
            workplace_stress: 'Ø¶ØºØ· Ø§Ù„Ø¹Ù…Ù„',
            family_stress: 'Ø¶ØºØ· Ø¹Ø§Ø¦Ù„ÙŠ',
            anxiety: 'Ù‚Ù„Ù‚',
            depression: 'Ø§ÙƒØªØ¦Ø§Ø¨',
            cannot_sleep: 'Ù„Ø§ Ø£Ø³ØªØ·ÙŠØ¹ Ø§Ù„Ù†ÙˆÙ…',
            panic_attack: 'Ù†ÙˆØ¨Ø© Ù‡Ù„Ø¹',
            suicidal: 'Ø£ÙÙƒØ§Ø± Ø§Ù†ØªØ­Ø§Ø±ÙŠØ©',
            other: 'Ø£Ø®Ø±Ù‰',
            additional_details: 'ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)',
            continue: 'Ù…ØªØ§Ø¨Ø¹Ø©',
            support_type: 'Ù†ÙˆØ¹ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨',
            resources_coming: 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ (Ù‚Ø±ÙŠØ¨Ø§Ù‹)',
            counselor_coming: 'Ø§Ù„Ù…Ø³ØªØ´Ø§Ø± (Ù‚Ø±ÙŠØ¨Ø§Ù‹)',
            healthcare_facilities: 'Ø§Ù„Ù…Ø±Ø§ÙÙ‚ Ø§Ù„ØµØ­ÙŠØ©',
            enter_location: 'Ø£Ø¯Ø®Ù„ Ù…ÙˆÙ‚Ø¹Ùƒ',
            search: 'Ø¨Ø­Ø«',
            government_facilities: 'Ù…Ø±Ø§ÙÙ‚ Ø§Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ© Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ©',
            back_support: 'â†’ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø¯Ø¹Ù…',
            map_title: 'Ø®Ø±ÙŠØ·Ø© Ù…Ø±Ø§ÙÙ‚ Ø§Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ©',
            map_subtitle: 'Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø¯ÙŠÙ†ØªÙƒ Ù„Ø¥ÙŠØ¬Ø§Ø¯ Ø£Ù‚Ø±Ø¨ Ù…Ø±ÙÙ‚',
            reset_link_sent: 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¥Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ!',
            signin_success: 'âœ“ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!',
            signin_error: 'âœ— Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.',
            location_prompt: 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙˆÙ‚Ø¹Ùƒ',
            select_support: 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø®ÙŠØ§Ø± Ø¯Ø¹Ù… ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„',
            sentiment_positive: 'âœ“ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ: Ø±Ø³Ø§Ù„ØªÙƒ ØªØ¸Ù‡Ø± Ø§Ù„Ù…Ø±ÙˆÙ†Ø© ÙˆØ§Ù„Ø£Ù…Ù„. Ø£Ù†Øª ØªØªØ®Ø° Ø®Ø·ÙˆØ§Øª Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ© Ù„Ù„Ø£Ù…Ø§Ù….',
            sentiment_neutral: 'âš  ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ: ÙŠØ¨Ø¯Ùˆ Ø£Ù†Ùƒ ØªØ¹Ø§Ù„Ø¬ Ù…Ø´Ø§Ø¹Ø± Ù…Ø¹Ù‚Ø¯Ø©. Ù‡Ø°Ø§ Ø·Ø¨ÙŠØ¹ÙŠ ØªÙ…Ø§Ù…Ø§Ù‹.',
            sentiment_negative: 'âš  ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ: Ù†ÙƒØªØ´Ù Ø£Ù†Ùƒ Ù‚Ø¯ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¯Ø¹Ù… Ø¹Ø§Ø¬Ù„. Ù„Ø§ ØªØªØ±Ø¯Ø¯ ÙÙŠ Ø·Ù„Ø¨ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©.',
            nearest_facility: 'Ø£Ù‚Ø±Ø¨ Ù…Ø±ÙÙ‚:',
            km_away: 'ÙƒÙ…',
            // Chatbot responses in Arabic
            chat_greeting: 'Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ© Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ. ğŸ¤– ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ:\n\nâ€¢ Ø¥ÙŠØ¬Ø§Ø¯ Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ©\nâ€¢ ÙÙ‡Ù… Ù…Ø´Ø§Ø¹Ø±Ùƒ\nâ€¢ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø±Ø§ÙÙ‚\nâ€¢ Ø§Ù„Ø¯Ø¹Ù… ÙÙŠ Ø§Ù„Ø£Ø²Ù…Ø§Øª\n\nÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ',
            crisis_response: 'ğŸš¨ Ø£ÙÙ‡Ù… Ø£Ù†Ùƒ ÙÙŠ Ø£Ø²Ù…Ø©. Ø­ÙŠØ§ØªÙƒ Ù…Ù‡Ù…Ø©.\n\nØ§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„: 920033360 (Ø®Ø· Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ©) - Ù…ØªØ§Ø­ Ø¹Ù„Ù‰ Ù…Ø¯Ø§Ø± Ø§Ù„Ø³Ø§Ø¹Ø©\n\nÙŠÙ…ÙƒÙ†Ùƒ Ø£ÙŠØ¶Ø§Ù‹ Ù…Ø±Ø§Ø³Ù„ØªÙ‡Ù…. Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ù†ÙŠ Ø¥Ø¸Ù‡Ø§Ø± Ù…Ø±Ø§ÙÙ‚ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ Ø§Ù„Ù‚Ø±ÙŠØ¨Ø©ØŸ',
            anxiety_response: 'ğŸ˜° Ø§Ù„Ù‚Ù„Ù‚ Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ù…Ø±Ù‡Ù‚Ø§Ù‹ØŒ Ù„ÙƒÙ†Ùƒ Ù„Ø³Øª ÙˆØ­Ø¯Ùƒ.\n\nâœ¨ Ø¬Ø±Ø¨ Ù‡Ø°Ø§ Ø§Ù„Ø¢Ù†:\nâ€¢ Ø§Ø³ØªÙ†Ø´Ù‚ Ø¨Ø¨Ø·Ø¡ Ù„Ù…Ø¯Ø© 4 Ø¹Ø¯Ø§Øª\nâ€¢ Ø§Ø­Ø¨Ø³ Ù„Ù…Ø¯Ø© 4 Ø¹Ø¯Ø§Øª\nâ€¢ Ø§Ø²ÙØ± Ù„Ù…Ø¯Ø© 4 Ø¹Ø¯Ø§Øª\nâ€¢ ÙƒØ±Ø± 5 Ù…Ø±Ø§Øª\n\nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø±Ø¤ÙŠØ© Ù…ÙˆØ§Ø±Ø¯ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ù„Ù‚ Ø£Ùˆ Ø§Ù„ØªØ­Ø¯Ø« Ù…Ø¹ Ù…ØªØ®ØµØµØŸ',
            depression_response: 'ğŸ’™ Ø´ÙƒØ±Ø§Ù‹ Ø¹Ù„Ù‰ Ù…Ø´Ø§Ø±ÙƒØªÙƒ. Ø§Ù„Ø§ÙƒØªØ¦Ø§Ø¨ Ø­Ø§Ù„Ø© Ø·Ø¨ÙŠØ© Ø­Ù‚ÙŠÙ‚ÙŠØ©ØŒ ÙˆÙŠÙ…ÙƒÙ† Ø¹Ù„Ø§Ø¬Ù‡Ø§.\n\nØªØ³ØªØ­Ù‚ Ø§Ù„Ø¯Ø¹Ù…. ØªÙ‚Ø¯Ù… Ù…Ø±Ø§ÙÙ‚Ù†Ø§:\nâ€¢ Ø§Ø³ØªØ´Ø§Ø±Ø§Øª Ù…Ù‡Ù†ÙŠØ©\nâ€¢ Ø¹Ù„Ø§Ø¬ Ø·Ø¨ÙŠ\nâ€¢ Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø¯Ø¹Ù…\n\nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø±Ø¤ÙŠØ© Ù…Ø±Ø§ÙƒØ² Ø§Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ© Ø§Ù„Ù‚Ø±ÙŠØ¨Ø©ØŸ',
            stress_response: 'ğŸ˜“ Ø§Ù„Ø¶ØºØ· ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù…ÙŠØ¹ Ø¨Ø´ÙƒÙ„ Ù…Ø®ØªÙ„Ù. Ø¯Ø¹Ù†ÙŠ Ø£Ø³Ø§Ø¹Ø¯Ùƒ ÙÙŠ Ø¥ÙŠØ¬Ø§Ø¯ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ù…Ù†Ø§Ø³Ø¨.\n\nÙ…Ø§ Ù†ÙˆØ¹ Ø§Ù„Ø¶ØºØ· Ø§Ù„Ø°ÙŠ ØªØ¹Ø§Ù†ÙŠ Ù…Ù†Ù‡ØŸ\nâ€¢ Ø§Ù„Ø¹Ù…Ù„/Ø§Ù„Ø¯Ø±Ø§Ø³Ø©\nâ€¢ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©\nâ€¢ Ø§Ù„Ù…Ø§Ù„ÙŠ\nâ€¢ Ø§Ù„ØµØ­Ø©\n\nÙŠÙ…ÙƒÙ†Ù†ÙŠ ØªÙˆÙÙŠØ± Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª ØªØ£Ù‚Ù„Ù… Ù…Ø®ØµØµØ©.',
            sleep_response: 'ğŸ˜´ Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù†ÙˆÙ… ØºØ§Ù„Ø¨Ø§Ù‹ Ù…Ø§ ØªØ±ØªØ¨Ø· Ø¨Ø§Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ©.\n\nğŸ’¡ Ù†ØµØ§Ø¦Ø­ Ù„Ù†ÙˆÙ… Ø£ÙØ¶Ù„:\nâ€¢ Ø§Ù„ØªØ²Ù… Ø¨Ø¬Ø¯ÙˆÙ„ Ù…Ù†ØªØ¸Ù…\nâ€¢ ØªØ¬Ù†Ø¨ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ù†ÙˆÙ… Ø¨Ø³Ø§Ø¹Ø©\nâ€¢ Ø£Ù†Ø´Ø¦ Ø±ÙˆØªÙŠÙ† Ù…Ù‡Ø¯Ø¦\nâ€¢ Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø¨Ø±ÙˆØ¯Ø© Ø§Ù„ØºØ±ÙØ© ÙˆØ¸Ù„Ø§Ù…Ù‡Ø§\n\nØ¥Ø°Ø§ Ø§Ø³ØªÙ…Ø± Ù‡Ø°Ø§ØŒ ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…ØªØ®ØµØµÙŠÙ† Ù„Ø¯ÙŠÙ†Ø§ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø¬Ø² Ø§Ø³ØªØ´Ø§Ø±Ø©ØŸ',
            facilities_response: 'ğŸ¥ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø¥Ø¸Ù‡Ø§Ø± Ù…Ø±Ø§ÙÙ‚ Ø§Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ© ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©.\n\nÙ„Ø¯ÙŠÙ†Ø§ Ù…Ø±Ø§ÙƒØ² ÙÙŠ:\nâ€¢ Ø§Ù„Ø±ÙŠØ§Ø¶ - Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø£Ù…Ù„\nâ€¢ Ø¬Ø¯Ø© - Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø£Ù…Ù„\nâ€¢ Ø§Ù„Ø¯Ù…Ø§Ù… - Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø£Ù…Ù„\n\nØ£ÙŠ Ù…Ø¯ÙŠÙ†Ø© Ø£Ù‚Ø±Ø¨ Ù„ÙƒØŒ Ø£Ù… ØªØ±ÙŠØ¯ Ø±Ø¤ÙŠØ© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ØŸ',
            thank_response: 'ğŸ’š Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø­Ø¨ ÙˆØ§Ù„Ø³Ø¹Ø©! ØªØ°ÙƒØ±:\n\nâœ¨ Ø·Ù„Ø¨ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¹Ù„Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙˆØ©ØŒ ÙˆÙ„ÙŠØ³ Ø§Ù„Ø¶Ø¹Ù\nâœ¨ Ù„Ø§ ÙŠØ¬Ø¨ Ø£Ù† ØªÙˆØ§Ø¬Ù‡ Ù‡Ø°Ø§ ÙˆØ­Ø¯Ùƒ\nâœ¨ Ø§Ù„ØªØ¹Ø§ÙÙŠ Ù…Ù…ÙƒÙ†\n\nØ£Ù†Ø§ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù‡Ù†Ø§ Ø¥Ø°Ø§ Ø§Ø­ØªØ¬Øª Ù„Ù„Ø¯Ø¹Ù…. Ø§Ø¹ØªÙ† Ø¨Ù†ÙØ³Ùƒ!',
            help_response: 'ğŸ¤ Ø£Ù†Ø§ Ù‡Ù†Ø§ Ù„Ø¯Ø¹Ù…Ùƒ. ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ:\n\n1ï¸âƒ£ Ø¯Ø¹Ù… Ø§Ù„Ø£Ø²Ù…Ø§Øª ÙˆØ¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ø·Ø§Ø±Ø¦Ø©\n2ï¸âƒ£ ÙÙ‡Ù… Ø­Ø§Ù„Ø§Øª Ø§Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ©\n3ï¸âƒ£ Ø¥ÙŠØ¬Ø§Ø¯ Ø§Ù„Ù…Ø±Ø§ÙÙ‚ Ø§Ù„Ù‚Ø±ÙŠØ¨Ø©\n4ï¸âƒ£ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª ÙˆØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„ØªØ£Ù‚Ù„Ù…\n5ï¸âƒ£ Ø­Ø¬Ø² Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯\n\nÙ…Ø§ Ø§Ù„Ø°ÙŠ Ø³ÙŠÙƒÙˆÙ† Ø£ÙƒØ«Ø± ÙØ§Ø¦Ø¯Ø© Ù„Ùƒ Ø§Ù„Ø¢Ù†ØŸ',
            default_response: 'Ø£Ù†Ø§ Ø£Ø³ØªÙ…Ø¹. ğŸ‘‚ Ù…Ø´Ø§Ø¹Ø±Ùƒ ØµØ­ÙŠØ­Ø©.\n\nÙ‡Ù„ ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø®Ø¨Ø§Ø±ÙŠ Ø§Ù„Ù…Ø²ÙŠØ¯ Ø¹Ù…Ø§ ØªÙ…Ø± Ø¨Ù‡ØŸ ÙƒÙ„Ù…Ø§ Ø´Ø§Ø±ÙƒØª Ø£ÙƒØ«Ø±ØŒ ÙƒÙ„Ù…Ø§ ØªÙ…ÙƒÙ†Øª Ù…Ù† Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø¨Ø´ÙƒÙ„ Ø£ÙØ¶Ù„ ÙÙŠ Ø¥ÙŠØ¬Ø§Ø¯ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ù…Ù†Ø§Ø³Ø¨.',
            how_can_help: 'ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒØŸ',
            im_thinking: 'Ø£Ù†Ø§ Ø£ÙÙƒØ±...'
        }
    };

    // City coordinates for distance calculation
    var cities = {
        'riyadh': {
            lat: 24.7136,
            lng: 46.6753,
            ar: 'Ø§Ù„Ø±ÙŠØ§Ø¶'
        },
        'jeddah': {
            lat: 21.5433,
            lng: 39.1728,
            ar: 'Ø¬Ø¯Ø©'
        },
        'dammam': {
            lat: 26.4207,
            lng: 50.0888,
            ar: 'Ø§Ù„Ø¯Ù…Ø§Ù…'
        },
        'mecca': {
            lat: 21.4225,
            lng: 39.8262,
            ar: 'Ù…ÙƒØ©'
        },
        'medina': {
            lat: 24.5247,
            lng: 39.5692,
            ar: 'Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©'
        },
        'khobar': {
            lat: 26.2172,
            lng: 50.1971,
            ar: 'Ø§Ù„Ø®Ø¨Ø±'
        },
        'tabuk': {
            lat: 28.3838,
            lng: 36.5550,
            ar: 'ØªØ¨ÙˆÙƒ'
        },
        'abha': {
            lat: 18.2164,
            lng: 42.5053,
            ar: 'Ø£Ø¨Ù‡Ø§'
        }
    };

    function showPage(id) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    function showTab(tab) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        event.target.classList.add('active');
        document.getElementById(tab + '-content').classList.add('active');
        hideForgotPassword();
    }

    function showForgotPassword() {
        document.getElementById('forgot-section').classList.add('active');
    }

    function hideForgotPassword() {
        document.getElementById('forgot-section').classList.remove('active');
    }

    function sendResetLink() {
        alert(translations[currentLang].reset_link_sent);
        hideForgotPassword();
    }

    function handleSignIn() {
        var u = document.getElementById('signin-username').value;
        var p = document.getElementById('signin-password').value;
        var m = document.getElementById('signin-message');

        if (u.toLowerCase() === 'bitaintech' && p === 'BitainTech1234!') {
            m.style.display = 'block';
            m.style.backgroundColor = '#d4edda';
            m.style.color = '#155724';
            m.textContent = translations[currentLang].signin_success;
            setTimeout(() => showPage('page5'), 1500);
        } else {
            m.style.display = 'block';
            m.style.backgroundColor = '#f8d7da';
            m.style.color = '#721c24';
            m.textContent = translations[currentLang].signin_error;
        }
    }

    function handleAccountCreation() {
        var lang = document.getElementById('language').value;
        if (lang) {
            currentLang = lang;
            changeLanguage(lang);
            showPage('page4');
        }
    }

    function changeLanguage(lang) {
        currentLang = lang;
        if (lang === 'arabic') {
            document.body.classList.add('rtl');
        } else {
            document.body.classList.remove('rtl');
        }
        updateTranslations();
    }

    function updateTranslations() {
        // Update all elements with data-translate attribute
        document.querySelectorAll('[data-translate]').forEach(el => {
            var key = el.getAttribute('data-translate');
            if (translations[currentLang][key]) {
                el.innerHTML = translations[currentLang][key];
            }
        });

        // Update chatbot title
        var chatTitle = currentLang === 'arabic' ? 'Ø¯Ø¹Ù… Ø§Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ©' : 'Mental Health Support';
        document.getElementById('chatbot-title').textContent = chatTitle;

        // Update input placeholders
        document.getElementById('chatInput').placeholder =
        currentLang === 'arabic' ? 'Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©...' : 'Type a message...';
        document.getElementById('location-search').placeholder =
        currentLang === 'arabic' ? 'Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø£Ùˆ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©' : 'City or Region';
        document.getElementById('additional-details').placeholder =
        currentLang === 'arabic' ? 'Ø´Ø§Ø±Ùƒ Ø¨Ù‚Ø¯Ø± Ù…Ø§ ØªØ´Ø¹Ø± Ø¨Ø§Ù„Ø±Ø§Ø­Ø©...' : 'Share as much or as little as you\'re comfortable with...';
    }

    // AI Feature #1: Sentiment Analysis with keyword detection
    function analyzeSentiment() {
        var feeling = document.getElementById('feeling').value;
        var details = document.getElementById('additional-details').value.toLowerCase();
        var result = document.getElementById('sentiment-result');

        // Keyword arrays for sentiment analysis
        var negativeWords = ['hopeless', 'suicidal', 'die', 'kill', 'end', 'pain', 'suffer', 'alone', 'worthless', 'hate', 'awful', 'terrible',
        'ÙŠØ§Ø¦Ø³', 'Ø§Ù†ØªØ­Ø§Ø±', 'Ù…ÙˆØª', 'Ù‚ØªÙ„', 'Ù†Ù‡Ø§ÙŠØ©', 'Ø£Ù„Ù…', 'Ù…Ø¹Ø§Ù†Ø§Ø©', 'ÙˆØ­ÙŠØ¯', 'Ø¹Ø¯ÙŠÙ… Ø§Ù„Ù‚ÙŠÙ…Ø©', 'Ø£ÙƒØ±Ù‡', 'ÙØ¸ÙŠØ¹'];
        var positiveWords = ['hope', 'better', 'trying', 'help', 'support', 'improve', 'grateful', 'thanks', 'progress', 'happy',
        'Ø£Ù…Ù„', 'Ø£ÙØ¶Ù„', 'Ù…Ø­Ø§ÙˆÙ„Ø©', 'Ù…Ø³Ø§Ø¹Ø¯Ø©', 'Ø¯Ø¹Ù…', 'ØªØ­Ø³ÙŠÙ†', 'Ù…Ù…ØªÙ†', 'Ø´ÙƒØ±Ø§Ù‹', 'ØªÙ‚Ø¯Ù…', 'Ø³Ø¹ÙŠØ¯'];

        var sentiment = 'neutral';
        var score = 0;

        // High priority: check feeling selection
        if (feeling === 'suicidal' || feeling === 'panic-attack') {
            sentiment = 'negative';
            score = -10;
        } else if (feeling === 'depression' || feeling === 'anxiety') {
            score -= 3;
        } else if (feeling === 'sad' || feeling === 'overwhelmed') {
            score -= 2;
        }

        // Analyze text details
        negativeWords.forEach(word => {
            if (details.includes(word))
                score -= 1;
        });
        positiveWords.forEach(word => {
            if (details.includes(word))
                score += 1;
        });

        // Determine final sentiment
        if (score >= 2)
            sentiment = 'positive';
        else if (score <= -3)
            sentiment = 'negative';

        var sentimentClass = 'sentiment-' + sentiment;
        var message = translations[currentLang]['sentiment_' + sentiment];

        result.innerHTML = '<div class="sentiment-indicator ' + sentimentClass + '">' + message + '</div>';

        setTimeout(() => showPage('page6'), 2500);
    }

    function handleSupportSelection() {
        if (document.getElementById('healthcare-check').checked) {
            showPage('page7');
        } else {
            alert(translations[currentLang].select_support);
        }
    }

    // Calculate distance between two coordinates (Haversine formula)
    function getDistance(lat1, lng1, lat2, lng2) {
        var R = 6371; // Earth's radius in km
        var dLat = (lat2 - lat1) * Math.PI / 180;
        var dLng = (lng2 - lng1) * Math.PI / 180;
        var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
        Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
        Math.sin(dLng / 2) * Math.sin(dLng / 2);
        var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
        return R * c;
    }

    function searchLocation() {
        var loc = document.getElementById('location-search').value.toLowerCase().trim();
        if (!loc) {
            alert(translations[currentLang].location_prompt);
            return;
        }

        // Find matching city
        var cityData = null;
        for (var city in cities) {
            if (loc.includes(city) || loc.includes(cities[city].ar)) {
                cityData = cities[city];
                cityData.name = city;
                break;
            }
        }

        if (!cityData) {
            // Default to Riyadh if city not found
            cityData = cities['riyadh'];
            cityData.name = 'riyadh';
            alert((currentLang === 'arabic' ? 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©. Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù…Ù† Ø§Ù„Ø±ÙŠØ§Ø¶.' : 'City not found. Showing results from Riyadh.'));
        }

        userLocation = cityData;

        // Calculate distances and update UI
        var facilities = document.querySelectorAll('.facility-card');
        var nearest = null;
        var minDist = Infinity;

        facilities.forEach(function(card) {
            var facLat = parseFloat(card.getAttribute('data-lat'));
            var facLng = parseFloat(card.getAttribute('data-lng'));
            var distance = getDistance(cityData.lat, cityData.lng, facLat, facLng);

            var badge = card.querySelector('.distance-badge');
            badge.style.display = 'inline-block';
            badge.textContent = distance.toFixed(1) + ' ' + (currentLang === 'arabic' ? 'ÙƒÙ…' : 'km');

            if (distance < minDist) {
                minDist = distance;
                nearest = card;
            }
        });

        // Highlight nearest facility
        facilities.forEach(card => card.classList.remove('selected'));
        if (nearest) {
            nearest.classList.add('selected');
            nearest.scrollIntoView({
                behavior: 'smooth',
                block: 'center'
            });
        }

        // Update map info
        var distInfo = document.getElementById('distance-info');
        distInfo.textContent = (currentLang === 'arabic' ? 'Ø£Ù‚Ø±Ø¨ Ù…Ø±ÙÙ‚: ' : 'Nearest facility: ') +
        minDist.toFixed(1) + ' ' +
        (currentLang === 'arabic' ? 'ÙƒÙ…' : 'km away');
    }

    function selectFacility(card) {
        document.querySelectorAll('.facility-card').forEach(c => c.classList.remove('selected'));
        card.classList.add('selected');
    }

    // AI Feature #2: Intelligent Chatbot with context awareness
    function toggleChatbot() {
        var chatbot = document.getElementById('chatbot');
        chatbot.classList.toggle('open');
        if (chatbot.classList.contains('open') && document.getElementById('chatMessages').children.length === 0) {
            addBotMessage(translations[currentLang].chat_greeting);
        }
    }

    function sendMessage() {
        var input = document.getElementById('chatInput');
        var msg = input.value.trim();
        if (msg) {
            addUserMessage(msg);
            chatHistory.push({
                role: 'user',
                message: msg
            });
            input.value = '';

            // Show typing indicator
            var typingDiv = document.createElement('div');
            typingDiv.className = 'message bot typing-indicator-msg';
            typingDiv.innerHTML = '<div class="typing-indicator"><span></span><span></span><span></span></div>';
            document.getElementById('chatMessages').appendChild(typingDiv);
            document.getElementById('chatMessages').scrollTop = 999999;

            setTimeout(() => {
                typingDiv.remove();
                respondToMessage(msg);
            }, 1000);
        }
    }

    function addUserMessage(text) {
        var div = document.createElement('div');
        div.className = 'message user';
        div.textContent = text;
        document.getElementById('chatMessages').appendChild(div);
        document.getElementById('chatMessages').scrollTop = 999999;
    }

    function addBotMessage(text) {
        var div = document.createElement('div');
        div.className = 'message bot';
        div.style.whiteSpace = 'pre-line'; // Preserve line breaks
        div.textContent = text;
        document.getElementById('chatMessages').appendChild(div);
        chatHistory.push({
            role: 'bot',
            message: text
        });
        document.getElementById('chatMessages').scrollTop = 999999;
    }

    function respondToMessage(msg) {
        var msgLower = msg.toLowerCase();
        var response = '';

        // Define keyword categories for intelligent matching
        var crisisKeywords = ['suicide', 'suicidal', 'kill myself', 'end my life', 'die', 'death', 'want to die',
        'Ø§Ù†ØªØ­Ø§Ø±', 'Ø§Ù‚ØªÙ„ Ù†ÙØ³ÙŠ', 'Ø§Ù†Ù‡Ø§Ø¡ Ø­ÙŠØ§ØªÙŠ', 'Ù…ÙˆØª', 'Ø£Ø±ÙŠØ¯ Ø£Ù† Ø£Ù…ÙˆØª', 'Ø§Ù„Ù…ÙˆØª'];

        var anxietyKeywords = ['anxious', 'anxiety', 'panic', 'worry', 'worried', 'scared', 'fear', 'nervous', 'stress',
        'Ù‚Ù„Ù‚', 'Ù‚Ù„Ù‚Ø§Ù†', 'Ù‡Ù„Ø¹', 'Ø®Ø§Ø¦Ù', 'Ø®ÙˆÙ', 'ØªÙˆØªØ±', 'Ù…ØªÙˆØªØ±'];

        var depressionKeywords = ['depressed', 'depression', 'sad', 'sadness', 'hopeless', 'lonely', 'empty', 'numb',
        'Ø§ÙƒØªØ¦Ø§Ø¨', 'Ù…ÙƒØªØ¦Ø¨', 'Ø­Ø²ÙŠÙ†', 'Ø­Ø²Ù†', 'ÙŠØ§Ø¦Ø³', 'ÙˆØ­ÙŠØ¯', 'ÙØ±Ø§Øº'];

        var stressKeywords = ['stress', 'stressed', 'overwhelmed', 'pressure', 'tired', 'exhausted', 'burnout',
        'Ø¶ØºØ·', 'Ù…Ø¶ØºÙˆØ·', 'Ù…Ø±Ù‡Ù‚', 'ØªØ¹Ø¨', 'Ù…ØªØ¹Ø¨', 'Ø¥Ø±Ù‡Ø§Ù‚'];

        var sleepKeywords = ['sleep', 'sleeping', 'insomnia', 'cant sleep', 'cannot sleep', 'tired', 'awake',
        'Ù†ÙˆÙ…', 'Ø£Ø±Ù‚', 'Ù„Ø§ Ø£Ø³ØªØ·ÙŠØ¹ Ø§Ù„Ù†ÙˆÙ…', 'Ù…Ø§ Ø£Ù‚Ø¯Ø± Ø£Ù†Ø§Ù…'];

        var facilitiesKeywords = ['facility', 'facilities', 'hospital', 'center', 'clinic', 'location', 'where', 'find',
        'Ù…Ø±ÙÙ‚', 'Ù…Ø±Ø§ÙÙ‚', 'Ù…Ø³ØªØ´ÙÙ‰', 'Ù…Ø±ÙƒØ²', 'Ø¹ÙŠØ§Ø¯Ø©', 'Ù…ÙˆÙ‚Ø¹', 'Ø£ÙŠÙ†', 'Ø§Ø¨Ø­Ø«'];

        var thankKeywords = ['thank', 'thanks', 'appreciate', 'grateful', 'Ø´ÙƒØ±', 'Ø´ÙƒØ±Ø§Ù‹', 'Ø§Ø´ÙƒØ±Ùƒ', 'Ù…Ù…ØªÙ†'];

        var helpKeywords = ['help', 'Ù…Ø³Ø§Ø¹Ø¯Ø©', 'Ø³Ø§Ø¹Ø¯Ù†ÙŠ', 'need help', 'can you help'];

        var greetingKeywords = ['hello', 'hi', 'hey', 'Ù…Ø±Ø­Ø¨Ø§', 'Ø§Ù„Ø³Ù„Ø§Ù…', 'Ø£Ù‡Ù„Ø§'];

        // Check for greetings
        if (greetingKeywords.some(word => msgLower.includes(word)) && chatHistory.length <= 2) {
            response = translations[currentLang].chat_greeting;
        }

        else // Check for crisis (highest priority)
        if (crisisKeywords.some(word => msgLower.includes(word))) {
            response = translations[currentLang].crisis_response;
        }

        else // Check for anxiety
        if (anxietyKeywords.some(word => msgLower.includes(word))) {
            response = translations[currentLang].anxiety_response;
        }

        else // Check for depression
        if (depressionKeywords.some(word => msgLower.includes(word))) {
            response = translations[currentLang].depression_response;
        }

        else // Check for stress
        if (stressKeywords.some(word => msgLower.includes(word))) {
            response = translations[currentLang].stress_response;
        }

        else // Check for sleep issues
        if (sleepKeywords.some(word => msgLower.includes(word))) {
            response = translations[currentLang].sleep_response;
        }

        else // Check for facilities
        if (facilitiesKeywords.some(word => msgLower.includes(word))) {
            response = translations[currentLang].facilities_response;
        }

        else // Check for thank you
        if (thankKeywords.some(word => msgLower.includes(word))) {
            response = translations[currentLang].thank_response;
        }

        else // Check for help request
        if (helpKeywords.some(word => msgLower.includes(word))) {
            response = translations[currentLang].help_response;
        }

        else // Default empathetic response
        {
            response = translations[currentLang].default_response;
        }

        addBotMessage(response);
    }

    // Enter key to send message
    document.getElementById('chatInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            sendMessage();
        }
    });

    // Initialize with English translations
    updateTranslations();
    </script>
</body>
</html>
 none;"></span>
</div>

<div class="facility-card" data-city="jeddah" data-lat="21.5433" data-lng="39.1728" onclick="selectFacility(this)">
    <h4 style="color: #1a7f37; margin-bottom: 10px; font-size: 18px;">ğŸ¥ Al-Amal Hospital - Jeddah</h4>
    <p style="color: #666; font-size: 14px;">ğŸ“ Jeddah | Psychiatric treatment and addiction services</p>
    <p style="color: #999; font-size: 13px; margin-top: 8px;">ğŸ“ Phone: +966 12 234 5678</p>
    <span class="distance-badge" style="display: none;"></span>
</div>

<div class="facility-card" data-city="dammam" data-lat="26.4207" data-lng="50.0888" onclick="selectFacility(this)">
    <h4 style="color: #1a7f37; margin-bottom: 10px; font-size: 18px;">ğŸ¥ Al-Amal Hospital - Dammam</h4>
    <p style="color: #666; font-size: 14px;">ğŸ“ Dammam | Psychiatric treatment and addiction services</p>
    <p style="color: #999; font-size: 13px; margin-top: 8px;">ğŸ“ Phone: +966 13 234 5678</p>
    <span class="distance-badge" style="display:
